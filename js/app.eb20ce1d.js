(function(){"use strict";var e={4587:function(e,t,n){var o=n(9242),i=n(3396),r=n(7139);const a={key:0,class:"notLogin"},s={class:"card_title"},c=["onClick"],l={class:"card code"},u={class:"buttons_container"},p=(0,i._)("div",{class:"to_login_hint"},[(0,i._)("p",null,[(0,i.Uk)("請用 "),(0,i._)("span",{style:{color:"green"}},"LINE"),(0,i.Uk)(" 登入")])],-1),h=(0,i._)("div",{class:"to_login_hint"},[(0,i._)("p",null,"免費領取VIP會員卡")],-1),d={class:"link_button_container"},f=["src"],g={key:1};function m(e,t,n,o,m,_){return _.loginState?((0,i.wg)(),(0,i.iD)("div",g,[(0,i._)("p",null,(0,r.zw)(_.getShopType),1)])):((0,i.wg)(),(0,i.iD)("div",a,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.coffee_shops,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"card",key:t},[(0,i._)("div",s,[(0,i._)("p",null,(0,r.zw)(e.name),1)]),(0,i._)("button",{onClick:t=>_.login(e.loginType)},"LINE 登入",8,c)])))),128)),(0,i._)("div",l,[(0,i._)("div",u,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.tap_buttons,((e,t)=>((0,i.wg)(),(0,i.iD)("button",{key:t},[(0,i._)("p",null,(0,r.zw)(e.name),1)])))),128))]),p,h]),(0,i._)("div",d,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(m.button_array,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"link_button",key:t},[(0,i._)("img",{src:e.icon,class:"link_button_icon"},null,8,f),(0,i._)("p",null,(0,r.zw)(e.name),1)])))),128))])]))}n(2062);var _=n(4161),v=n.p+"img/member.4477b7f9.png",y={beforeMount(){this.handleLoginCallback()},computed:{loginState(){return this.$store.state.isLogin},getUserName(){return this.$store.state.userName},getShopType(){return this.$store.state.shopType}},data(){return{coffee_shops:[{name:"Bryant咖啡館",loginType:"Bryant"},{name:"cama coffee",loginType:"cama"},{name:"咖啡深藏",loginType:"soul"}],tap_buttons:[{name:"會員QR碼",id:"1"},{name:"手機載具",id:"2"}],button_array:[{icon:v,name:"會員"},{icon:v,name:"優惠卷"},{icon:v,name:"積點"},{icon:v,name:"價格"},{icon:v,name:"集點卡"},{icon:v,name:"抽獎"},{icon:v,name:"寄存卡"},{icon:v,name:"行銷活動"},{icon:v,name:"儲值信託"},{icon:v,name:"履約票卷"}]}},methods:{login(e){let t="https://access.line.me/oauth2/v2.1/authorize?";t+="response_type=code",t+="&client_id=1661441879",t+="&redirect_uri=https://qkqp3qr2.github.io/blankvue/",t+="&state=1",t+=`&routerType=${e}`,t+="&scope=openid%20profile",window.location.href=t,console.log("start login")},buildUrl(e){let t="https://access.line.me/oauth2/v2.1/authorize?";const n={response_type:"code",client_id:"1661441879",redirect_uri:"https://qkqp3qr2.github.io/blankvue/",state:"1",scope:"openid%20profile"};n.shop=e;const o=Object.entries(n).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&");return`${t}${o}`},async handleLoginCallback(){const e=window.location.href;console.log("currentUrl",e);const t=e.searchParams;console.log("pasrams",t);const n=new URLSearchParams(window.location.search).get("code");if(n){const e=await this.getAccessToken(n);await this.getUserProfile(e),this.$store.commit("setLoginState"),console.log("login successful")}else console.error("Authorization code not found.")},async getAccessToken(e){try{const t=await _.Z.post("https://api.line.me/oauth2/v2.1/token",new URLSearchParams({grant_type:"authorization_code",code:e,client_id:"1661441879",client_secret:"4f03d9065b14f7d6e394a0f20b0c53e3",redirect_uri:"https://qkqp3qr2.github.io/blankvue/"}).toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return t.data.access_token}catch(t){throw console.error("Failed to get access token:",t),t}},async getUserProfile(e){try{const t=await _.Z.get("https://api.line.me/v2/profile",{headers:{Authorization:`Bearer ${e}`}}),n=t.data;console.log(n),this.$store.commit("setUserName",n.displayName)}catch(t){console.error("Failed to get user profile:",t)}},async redirectTo(){const e=new URLSearchParams(window.location.search).get("shop");e?this.$store.commit("setShopType",e):this.$store.commit("setShopType","error")}}},b=n(89);const w=(0,b.Z)(y,[["render",m]]);var k=w,T=n(65);const L=(0,T.MT)({state(){return{isLogin:!1,userName:"",shopType:""}},mutations:{setLoginState(e){e.isLogin=!0},setUserName(e,t){e.userName=t},setShopType(e,t){e.shopType=t}}});var S=L;(0,o.ri)(k).use(S).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],i=e[u][1],r=e[u][2];for(var s=!0,c=0;c<o.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(s=!1,r<a&&(a=r));if(s){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],s=o[1],c=o[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var u=c(n)}for(t&&t(o);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunkblankevue"]=self["webpackChunkblankevue"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(4587)}));o=n.O(o)})();
//# sourceMappingURL=app.eb20ce1d.js.map