(function(){"use strict";var e={989:function(e,t,n){var o=n(9242),i=n(3396),r=n(7139);const a={key:0,class:"notLogin"},s={class:"card_title"},c={class:"card code"},l={class:"buttons_container"},u=(0,i._)("div",{class:"to_login_hint"},[(0,i._)("p",null,[(0,i.Uk)("請用 "),(0,i._)("span",{style:{color:"green"}},"LINE"),(0,i.Uk)(" 登入")])],-1),p=(0,i._)("div",{class:"to_login_hint"},[(0,i._)("p",null,"免費領取VIP會員卡")],-1),h={class:"link_button_container"},d=["src"],f={key:1};function g(e,t,n,o,g,m){return m.loginState?((0,i.wg)(),(0,i.iD)("div",f,[(0,i._)("p",null,(0,r.zw)(m.getShopType),1)])):((0,i.wg)(),(0,i.iD)("div",a,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(g.coffee_shops,((e,n)=>((0,i.wg)(),(0,i.iD)("div",{class:"card",key:n},[(0,i._)("div",s,[(0,i._)("p",null,(0,r.zw)(e.name),1)]),(0,i._)("button",{onClick:t[0]||(t[0]=(...e)=>m.login&&m.login(...e))},"LINE 登入")])))),128)),(0,i._)("div",c,[(0,i._)("div",l,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(g.tap_buttons,((e,t)=>((0,i.wg)(),(0,i.iD)("button",{key:t},[(0,i._)("p",null,(0,r.zw)(e.name),1)])))),128))]),u,p]),(0,i._)("div",h,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(g.button_array,((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"link_button",key:t},[(0,i._)("img",{src:e.icon,class:"link_button_icon"},null,8,d),(0,i._)("p",null,(0,r.zw)(e.name),1)])))),128))])]))}n(2062);var m=n(4161),_=n.p+"img/member.4477b7f9.png",v={beforeMount(){this.handleLoginCallback()},computed:{loginState(){return this.$store.state.isLogin},getUserName(){return this.$store.state.userName},getShopType(){return this.$store.state.shopType}},data(){return{coffee_shops:[{name:"Bryant咖啡館",loginRouter:"Bryant"},{name:"cama coffee",loginRouter:"cama"},{name:"咖啡深藏",loginRouter:"soul"}],tap_buttons:[{name:"會員QR碼",id:"1"},{name:"手機載具",id:"2"}],button_array:[{icon:_,name:"會員"},{icon:_,name:"優惠卷"},{icon:_,name:"積點"},{icon:_,name:"價格"},{icon:_,name:"集點卡"},{icon:_,name:"抽獎"},{icon:_,name:"寄存卡"},{icon:_,name:"行銷活動"},{icon:_,name:"儲值信託"},{icon:_,name:"履約票卷"}]}},methods:{login(e){const t=this.buildUrl(URL,e);window.location.href=t,console.log("start login")},buildUrl(e){let t="https://access.line.me/oauth2/v2.1/authorize?";const n={response_type:"code",client_id:"1661441879",redirect_uri:"https://qkqp3qr2.github.io/blankvue/",scope:"openid profile"};n.shop=e;const o=Object.entries(n).map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&");return`${t}?${o}`},async handleLoginCallback(){const e=new URLSearchParams(window.location.search).get("code");if(e){const t=await this.getAccessToken(e);await this.getUserProfile(t),this.$store.commit("setLoginState"),console.log("login successful")}else console.error("Authorization code not found.")},async getAccessToken(e){try{const t=await m.Z.post("https://api.line.me/oauth2/v2.1/token",new URLSearchParams({grant_type:"authorization_code",code:e,client_id:"1661441879",client_secret:"4f03d9065b14f7d6e394a0f20b0c53e3",redirect_uri:"https://qkqp3qr2.github.io/blankvue/"}).toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}});return t.data.access_token}catch(t){throw console.error("Failed to get access token:",t),t}},async getUserProfile(e){try{const t=await m.Z.get("https://api.line.me/v2/profile",{headers:{Authorization:`Bearer ${e}`}}),n=t.data;console.log(n),this.$store.commit("setUserName",n.displayName)}catch(t){console.error("Failed to get user profile:",t)}},async redirectTo(){const e=new URLSearchParams(window.location.search).get("shop");e?this.$store.commit("setShopType",e):this.$store.commit("setShopType","error")}}},b=n(89);const w=(0,b.Z)(v,[["render",g]]);var y=w,k=n(65);const T=(0,k.MT)({state(){return{isLogin:!1,userName:"",shopType:""}},mutations:{setLoginState(e){e.isLogin=!0},setUserName(e,t){e.userName=t},setShopType(e,t){e.shopType=t}}});var L=T;(0,o.ri)(y).use(L).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(u=0;u<e.length;u++){o=e[u][0],i=e[u][1],r=e[u][2];for(var s=!0,c=0;c<o.length;c++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[c])}))?o.splice(c--,1):(s=!1,r<a&&(a=r));if(s){e.splice(u--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],s=o[1],c=o[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(c)var u=c(n)}for(t&&t(o);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},o=self["webpackChunkblankevue"]=self["webpackChunkblankevue"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[998],(function(){return n(989)}));o=n.O(o)})();
//# sourceMappingURL=app.11f7770f.js.map